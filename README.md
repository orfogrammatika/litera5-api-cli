Консольное приложение API Литера5
=================================

Приложение предназначено для работы с API Литера5, как с его облачными серверами https://litera5.ru, так и с его 
локальными автономными версиями.

Его можно использовать для проверки настроек и отладки собственныю процедур интеграции, так и в качестве примера
использования JavaScript/TypeScript клиента API.

Установка
---------

### Глобальная установка

Установка приложения `l5-api` в операционную систему. Этот вариант подходит тем, кому нет необходимости разбираться с
программным кодом приложения, и нужна лишь его функциональность. Тогда все исполняемые файлы будут установлены в
операционную систему и пользователь сможет выполнять программу для достижения собственных целей.

```shell
npm install --global orfogrammatika/litera5-api-cli
```

После установки пользователю становится доступной команда `l5-api`.

### Локальная установка

Локальная установка предполагает доступ к исходникам, возможно внесение в них каких-то изменений, улучшений. В этом 
варианте пользователю нужно выполнить следующие команды:

```shell
> git clone git@github.com:orfogrammatika/litera5-api-cli.git
> cd litera5-api-cli
> yarn
```

После такой установки можно выполнять команды `yarn start` с теми же ключами что и для команды `l5-api`, только 
программа будет собираться из текущей версии исходников.

Использование
-------------

Несколько замечаний общего характера.

Для работы с API нужны некоторые общие (универсальные) настройки, а именно нужен URL сервера,
имя клиенти и секретный ключ. Имя клиента и секретный ключ получаются в службе поддержки Литеры
при подключении. Есть два пути настройки, записать их в файл или передать программке отдельными 
параметрами. Можно передать и то и то, тогда переданные отдельными параметрами значения победят
значения записанные в файле.

Файл можно сделать двух форматов (какой больше нравится) JSON или YAML. Это касается всех 
файлов настроек, как общих, так и параметров запросов.

Параметры конкретных команд тоже можно передать двумя путями. Можно передать их в виде 
параметра `--json '{"key": "value"}'` либо через файлик с параметрами запроса 
`--file some-request.yml`. Во всех случаях работает принцип, сначала берутся значения из файла
и затем переписываются значениями из отдельных параметров, если они существуют.

На этом базовые принципы заканчиваются.

А для всяких подробностей есть:

```shell
> l5-api --help
Usage: l5-api [options] [command]

Консольный клиент для работы с API Литера5

Options:
  -V, --version              output the version number
  -d, --debug                включает дополнительные отладочные сообщения (default: false)
  -u, --url <string>         базовый адрес сервера
  -l, --client <strint>      имя входа клиента
  -s, --secret <string>      секретный ключ клиента
  -c, --cfg <json-yml-file>  JSON/YML файл с настройками API
  -h, --help                 display help for command

Commands:
  setup [options]            Работа с настройками.
  user [options]             Создание нового пользователя или настройка существующего
  check [options]            Запуск интерактивной проверки документа
  check-ogxt [options]       Неинтерактивная проверка документа, запрос, ожидание результатов, 
                             запись результатов проверки в файл.
  help [command]             display help for command
```

Если этого не достаточно, то пишите вопросы/пожелания тут:
[litera5-api-cli/issues](https://github.com/orfogrammatika/litera5-api-cli/issues), будем дорабатывать.

Примеры
-------

В примерах использована команда `l5-api` как для варианта глобальной установки. В случае же локальной установки можно
все `l5-api` заменить на `yarn start`.

В каталоге `examples` собраны примеры файлов конфигурации и запросов. Подробная документация по самой API, запросам
и их содержимому доступна тут: [litera5-api-doc](https://github.com/orfogrammatika/litera5-api-doc).

### Настройка API ###

```shell
l5-api --cfg examples/cfg.yml setup --file examples/setup.yml
```

### Просмотр настроек API ###

```shell
l5-api --cfg examples/cfg.yml setup
```

### Проверка документа и получение результатов проверки ###

```shell
l5-api --cfg examples/cfg.yml check-ogxt --file examples/check.yml --html examples/check.html
```