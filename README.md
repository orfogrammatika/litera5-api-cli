Консольное приложение API Литера5
=================================

Приложение предназначено для работы с API Литера5, как с его облачными серверами https://litera5.ru, так и с его
локальными автономными версиями.

Его можно использовать для проверки настроек и отладки собственныю процедур интеграции, так и в качестве примера
использования JavaScript/TypeScript клиента API.

Установка
---------

### Локальная установка ###

Локальная установка предполагает доступ к исходникам, возможно внесение в них каких-то изменений, улучшений. В этом
варианте пользователю нужно выполнить следующие команды:

```shell
> git clone git@github.com:orfogrammatika/litera5-api-cli.git
> cd litera5-api-cli
> npm install
> npm run build
```

Или если вам больше нравится `yarn` вместо `npm` в качестве управлятеля пакетами (как нам), то:

```shell
> npm install --global yarn
> yarn
> yarn build
```

После такой установки можно выполнять команду `yarn start` для запуска программы.

### Глобальная установка команды `l5-api` ###

Если нужно иметь доступ к программе глобально, то после локальной установки в каталоге локальной установки нужно
выполнить команду:

```shell
> npm install --global .
```

После этого в системе появится команда `l5-api`.

Хотелось бы, чтобы для глобальной установки работала бы команда:
```shell
> npm install --global orfogrammatika/litera5-api-cli
```

Но она, увы, не работает. Ребята из npm об этом в курсе: https://github.com/npm/cli/issues/4148, но пока не исправили.

Поэтому пока так.

Использование
-------------

Несколько замечаний общего характера.

Для работы с API нужны некоторые общие (универсальные) настройки, а именно нужен URL сервера, имя клиенти и секретный
ключ. Имя клиента и секретный ключ получаются в службе поддержки Литеры при подключении. Есть два пути настройки,
записать их в файл или передать программке отдельными параметрами. Можно передать и то и то, тогда переданные отдельными
параметрами значения победят значения записанные в файле.

Файл можно сделать двух форматов (какой больше нравится) JSON или YAML. Это касается всех файлов настроек, как общих,
так и параметров запросов.

Параметры конкретных команд тоже можно передать двумя путями. Можно передать их в виде
параметра `--json '{"key": "value"}'` либо через файлик с параметрами запроса
`--file some-request.yml`. Во всех случаях работает принцип, сначала берутся значения из файла и затем переписываются
значениями из отдельных параметров, если они существуют.

На этом базовые принципы заканчиваются.

А для всяких подробностей есть:

```shell
> l5-api --help
Usage: l5-api [options] [command]

Консольный клиент для работы с API Литера5

Options:
  -V, --version              output the version number
  -d, --debug                включает дополнительные отладочные сообщения (default: false)
  -u, --url <string>         базовый адрес сервера
  -l, --client <strint>      имя входа клиента
  -s, --secret <string>      секретный ключ клиента
  -c, --cfg <json-yml-file>  JSON/YML файл с настройками API
  -h, --help                 display help for command

Commands:
  setup [options]            Работа с настройками.
  user [options]             Создание нового пользователя или настройка существующего
  check [options]            Запуск интерактивной проверки документа
  check-ogxt [options]       Неинтерактивная проверка документа, запрос, ожидание результатов, 
                             запись результатов проверки в файл.
  help [command]             display help for command
```

Если этого не достаточно, то пишите вопросы/пожелания тут:
[litera5-api-cli/issues](https://github.com/orfogrammatika/litera5-api-cli/issues), будем дорабатывать.

Примеры
-------

В примерах использована команда `l5-api` как для варианта глобальной установки. В случае же локальной установки можно
все `l5-api` заменить на `yarn start`.

В каталоге `examples` собраны примеры файлов конфигурации и запросов. Подробная документация по самой API, запросам и их
содержимому доступна тут: [litera5-api-doc](https://github.com/orfogrammatika/litera5-api-doc).

### Настройка API ###

```shell
l5-api --cfg examples/cfg.yml setup --file examples/setup.yml
```

### Просмотр настроек API ###

```shell
l5-api --cfg examples/cfg.yml setup
```

### Проверка документа и получение результатов проверки ###

```shell
l5-api --cfg examples/cfg.yml check-ogxt --file examples/check.yml --html examples/check.html
```